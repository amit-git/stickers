<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sticker Shop</title>
  <style>
    /* ── Design Tokens ─────────────────────────────────────────────────────── */
    :root {
      --cream:      #fdf8f3;
      --warm-white: #fff9f5;
      --blush:      #f5d6cc;
      --rose:       #e8a89c;
      --dusty-rose: #c9706a;
      --deep-rose:  #a04444;
      --sage:       #8faf8c;
      --sage-light: #c8ddc6;
      --charcoal:   #2d2d2d;
      --mid-gray:   #6b6b6b;
      --light-gray: #e8e4e0;
      --border:     #ddd5cc;
      --shadow-sm:  0 1px 3px rgba(0,0,0,0.08);
      --shadow-md:  0 4px 12px rgba(0,0,0,0.12);
      --shadow-lg:  0 8px 24px rgba(0,0,0,0.15);
      --radius:     8px;
      --radius-lg:  14px;
      --font-serif: 'Georgia', 'Times New Roman', serif;
      --font-sans:  'Helvetica Neue', Arial, sans-serif;
      --transition: 0.22s ease;
    }

    /* ── Reset & Base ──────────────────────────────────────────────────────── */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }
    body {
      font-family: var(--font-sans);
      background: var(--cream);
      color: var(--charcoal);
      line-height: 1.5;
      min-height: 100vh;
    }
    a { color: inherit; text-decoration: none; }
    button { cursor: pointer; border: none; background: none; font: inherit; }
    img { display: block; max-width: 100%; }

    /* ── Announcement Bar ──────────────────────────────────────────────────── */
    .announcement {
      background: var(--dusty-rose);
      color: #fff;
      text-align: center;
      padding: 8px 16px;
      font-size: 13px;
      letter-spacing: 0.04em;
    }

    /* ── Hero Section ───────────────────────────────────────────────────────── */
    .hero {
      width: 100%;
      background: var(--warm-white);
      position: relative;
      overflow: hidden;
    }
    .hero-image {
      width: 100%;
      height: auto;
      display: block;
    }
    .hero-image img {
      width: 100%;
      height: auto;
      object-fit: cover;
      object-position: center;
      display: block;
    }
    /* Responsive hero height */
    @media (max-width: 768px) {
      .hero-image {
        max-height: 50vh;
        overflow: hidden;
      }
    }

    /* ── Header / Nav ──────────────────────────────────────────────────────── */
    .site-header {
      background: var(--warm-white);
      border-bottom: 1px solid var(--border);
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: var(--shadow-sm);
    }
    .header-inner {
      max-width: 1320px;
      margin: 0 auto;
      padding: 0 24px;
      display: flex;
      align-items: center;
      gap: 24px;
      height: 68px;
    }
    .logo {
      font-family: var(--font-serif);
      font-size: 22px;
      font-weight: bold;
      color: var(--deep-rose);
      white-space: nowrap;
      letter-spacing: -0.02em;
    }
    .logo span { color: var(--sage); }

    .search-bar {
      flex: 1;
      max-width: 520px;
      position: relative;
    }
    .search-bar input {
      width: 100%;
      padding: 9px 40px 9px 14px;
      border: 1.5px solid var(--border);
      border-radius: 24px;
      font-size: 14px;
      background: var(--cream);
      color: var(--charcoal);
      transition: border-color var(--transition), box-shadow var(--transition);
      outline: none;
    }
    .search-bar input:focus {
      border-color: var(--rose);
      box-shadow: 0 0 0 3px rgba(232,168,156,0.18);
    }
    .search-bar input::placeholder { color: #b0a09a; }
    .search-icon {
      position: absolute;
      right: 12px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--mid-gray);
      pointer-events: none;
    }

    .sort-bar {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-left: auto;
    }
    .sort-bar label { font-size: 13px; color: var(--mid-gray); }
    .sort-bar select {
      padding: 7px 12px;
      border: 1.5px solid var(--border);
      border-radius: 6px;
      font-size: 13px;
      background: var(--warm-white);
      color: var(--charcoal);
      cursor: pointer;
      outline: none;
    }
    .sort-bar select:focus { border-color: var(--rose); }

    /* ── Layout ────────────────────────────────────────────────────────────── */
    .page-wrapper {
      max-width: 1320px;
      margin: 0 auto;
      padding: 28px 24px;
      display: flex;
      gap: 32px;
      align-items: flex-start;
    }

    /* ── Sidebar ───────────────────────────────────────────────────────────── */
    .sidebar {
      width: 220px;
      flex-shrink: 0;
      position: sticky;
      top: 96px;
    }
    .sidebar-section {
      background: var(--warm-white);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      padding: 18px 16px;
      margin-bottom: 16px;
    }
    .sidebar-title {
      font-size: 11px;
      font-weight: 700;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: var(--mid-gray);
      margin-bottom: 12px;
    }
    .tag-list { display: flex; flex-direction: column; gap: 2px; }
    .tag-btn {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 6px 10px;
      border-radius: 6px;
      font-size: 13px;
      color: var(--charcoal);
      transition: background var(--transition), color var(--transition);
      text-align: left;
      width: 100%;
    }
    .tag-btn:hover { background: var(--blush); color: var(--deep-rose); }
    .tag-btn.active {
      background: var(--dusty-rose);
      color: #fff;
      font-weight: 600;
    }
    .tag-btn .tag-count {
      font-size: 11px;
      opacity: 0.65;
      margin-left: 6px;
    }
    .tag-btn.active .tag-count { opacity: 0.8; }

    .clear-btn {
      width: 100%;
      padding: 8px;
      background: var(--light-gray);
      border-radius: 6px;
      font-size: 13px;
      color: var(--mid-gray);
      transition: background var(--transition);
      margin-top: 8px;
    }
    .clear-btn:hover { background: var(--blush); color: var(--deep-rose); }

    /* ── Main Area ─────────────────────────────────────────────────────────── */
    .main-area { flex: 1; min-width: 0; }

    .results-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
      flex-wrap: wrap;
      gap: 8px;
    }
    .results-count { font-size: 14px; color: var(--mid-gray); }
    .active-filter-tag {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: var(--blush);
      color: var(--deep-rose);
      border-radius: 20px;
      padding: 4px 12px;
      font-size: 13px;
      font-weight: 500;
    }
    .active-filter-tag button {
      font-size: 16px;
      line-height: 1;
      color: var(--dusty-rose);
      transition: color var(--transition);
    }
    .active-filter-tag button:hover { color: var(--deep-rose); }

    /* ── Product Grid ──────────────────────────────────────────────────────── */
    .product-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
    }

    /* ── Product Card ──────────────────────────────────────────────────────── */
    .product-card {
      background: var(--warm-white);
      border-radius: var(--radius-lg);
      overflow: hidden;
      border: 1px solid var(--border);
      cursor: pointer;
      transition: transform var(--transition), box-shadow var(--transition), border-color var(--transition);
      position: relative;
    }
    .product-card:hover {
      transform: translateY(-3px);
      box-shadow: var(--shadow-md);
      border-color: var(--rose);
    }

    /* Image container — square aspect ratio like Etsy/Amazon */
    .card-img-wrap {
      position: relative;
      width: 100%;
      aspect-ratio: 1 / 1;
      overflow: hidden;
      background: var(--light-gray);
    }
    .card-img-wrap img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.35s ease, opacity 0.2s ease;
    }
    /* Hover: show second image (Amazon/Etsy style) */
    .card-img-wrap .img-hover {
      position: absolute;
      inset: 0;
      opacity: 0;
      transition: opacity 0.28s ease;
    }
    .product-card:hover .card-img-wrap .img-hover { opacity: 1; }
    .product-card:hover .card-img-wrap .img-primary { opacity: 0; }

    /* Image dot indicators */
    .img-dots {
      position: absolute;
      bottom: 8px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 4px;
      opacity: 0;
      transition: opacity var(--transition);
    }
    .product-card:hover .img-dots { opacity: 1; }
    .img-dot {
      width: 5px;
      height: 5px;
      border-radius: 50%;
      background: rgba(255,255,255,0.6);
      border: 1px solid rgba(0,0,0,0.2);
    }
    .img-dot.active { background: #fff; }

    .card-body {
      padding: 12px 14px 14px;
    }
    .card-title {
      font-size: 13.5px;
      font-weight: 500;
      color: var(--charcoal);
      line-height: 1.35;
      margin-bottom: 6px;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
    .card-price {
      font-size: 15px;
      font-weight: 700;
      color: var(--deep-rose);
      margin-bottom: 8px;
    }
    /* tag chips removed from cards */

    /* ── Empty State ───────────────────────────────────────────────────────── */
    .empty-state {
      grid-column: 1 / -1;
      text-align: center;
      padding: 60px 24px;
      color: var(--mid-gray);
    }
    .empty-state h3 { font-size: 18px; margin-bottom: 8px; color: var(--charcoal); }
    .empty-state p { font-size: 14px; }

    /* ── Loading Skeleton ──────────────────────────────────────────────────── */
    .skeleton-card {
      background: var(--warm-white);
      border-radius: var(--radius-lg);
      overflow: hidden;
      border: 1px solid var(--border);
    }
    .skeleton-img {
      width: 100%;
      aspect-ratio: 1/1;
      background: linear-gradient(90deg, var(--light-gray) 25%, #ede8e4 50%, var(--light-gray) 75%);
      background-size: 200% 100%;
      animation: shimmer 1.4s infinite;
    }
    .skeleton-body { padding: 12px 14px 14px; }
    .skeleton-line {
      height: 13px;
      border-radius: 4px;
      background: linear-gradient(90deg, var(--light-gray) 25%, #ede8e4 50%, var(--light-gray) 75%);
      background-size: 200% 100%;
      animation: shimmer 1.4s infinite;
      margin-bottom: 8px;
    }
    .skeleton-line.short { width: 55%; }
    @keyframes shimmer {
      0%   { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }

    /* ── Pagination ────────────────────────────────────────────────────────── */
    .pagination {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 8px;
      margin-top: 36px;
      flex-wrap: wrap;
    }
    .page-btn {
      min-width: 36px;
      height: 36px;
      padding: 0 10px;
      border-radius: 6px;
      font-size: 14px;
      border: 1.5px solid var(--border);
      background: var(--warm-white);
      color: var(--charcoal);
      transition: all var(--transition);
    }
    .page-btn:hover:not(:disabled) { border-color: var(--rose); color: var(--deep-rose); background: var(--blush); }
    .page-btn.active { background: var(--dusty-rose); color: #fff; border-color: var(--dusty-rose); font-weight: 600; }
    .page-btn:disabled { opacity: 0.35; cursor: default; }

    /* ── Product Modal ─────────────────────────────────────────────────────── */
    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(30, 20, 18, 0.55);
      z-index: 200;
      display: flex;
      align-items: flex-start;
      justify-content: center;
      padding: 24px 16px;
      overflow-y: auto;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.25s ease;
    }
    .modal-backdrop.open { opacity: 1; pointer-events: all; }

    .modal {
      background: var(--warm-white);
      border-radius: var(--radius-lg);
      max-width: 880px;
      width: 100%;
      margin: auto;
      overflow: hidden;
      box-shadow: var(--shadow-lg);
      display: grid;
      grid-template-columns: 1fr 1fr;
      position: relative;
      transform: translateY(18px);
      transition: transform 0.25s ease;
    }
    .modal-backdrop.open .modal { transform: translateY(0); }

    .modal-close {
      position: absolute;
      top: 14px;
      right: 16px;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: rgba(255,255,255,0.85);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      color: var(--mid-gray);
      z-index: 10;
      transition: background var(--transition), color var(--transition);
      box-shadow: var(--shadow-sm);
    }
    .modal-close:hover { background: var(--blush); color: var(--deep-rose); }

    /* Gallery */
    .modal-gallery {
      position: relative;
      background: var(--light-gray);
      aspect-ratio: 1/1;
    }
    .gallery-main {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .gallery-thumbs {
      position: absolute;
      bottom: 12px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 6px;
      background: rgba(255,255,255,0.75);
      border-radius: 8px;
      padding: 5px;
      backdrop-filter: blur(4px);
    }
    .thumb-btn {
      width: 44px;
      height: 44px;
      border-radius: 5px;
      overflow: hidden;
      border: 2px solid transparent;
      transition: border-color var(--transition);
      cursor: pointer;
      flex-shrink: 0;
    }
    .thumb-btn img { width: 100%; height: 100%; object-fit: cover; }
    .thumb-btn.active { border-color: var(--dusty-rose); }

    .gallery-nav {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: rgba(255,255,255,0.85);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      color: var(--charcoal);
      box-shadow: var(--shadow-sm);
      transition: background var(--transition);
      z-index: 5;
    }
    .gallery-nav:hover { background: #fff; }
    .gallery-nav.prev { left: 10px; }
    .gallery-nav.next { right: 10px; }
    .gallery-nav:disabled { opacity: 0.3; cursor: default; }

    /* Modal info */
    .modal-info {
      padding: 28px 28px 28px 28px;
      display: flex;
      flex-direction: column;
      overflow-y: auto;
      max-height: 560px;
    }
    .modal-title {
      font-family: var(--font-serif);
      font-size: 20px;
      line-height: 1.3;
      color: var(--charcoal);
      margin-bottom: 12px;
    }
    .modal-price {
      font-size: 26px;
      font-weight: 700;
      color: var(--deep-rose);
      margin-bottom: 16px;
    }
    .modal-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 5px;
      margin-bottom: 18px;
    }
    .modal-tag-chip {
      font-size: 12px;
      padding: 3px 10px;
      border-radius: 20px;
      background: var(--blush);
      color: var(--deep-rose);
      cursor: pointer;
      transition: background var(--transition);
      font-weight: 500;
    }
    .modal-tag-chip:hover { background: var(--rose); color: #fff; }

    .modal-divider {
      border: none;
      border-top: 1px solid var(--border);
      margin: 0 0 16px;
    }
    .modal-desc-label {
      font-size: 11px;
      font-weight: 700;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: var(--mid-gray);
      margin-bottom: 8px;
    }
    .modal-desc {
      font-size: 13.5px;
      color: var(--mid-gray);
      line-height: 1.65;
      white-space: pre-line;
      flex: 1;
    }

    /* ── Cart Button (header) ──────────────────────────────────────────────── */
    .cart-btn {
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 42px;
      height: 42px;
      border-radius: 50%;
      color: var(--charcoal);
      flex-shrink: 0;
      transition: background var(--transition), color var(--transition);
    }
    .cart-btn:hover { background: var(--blush); color: var(--deep-rose); }
    .cart-badge {
      position: absolute;
      top: 2px;
      right: 2px;
      min-width: 17px;
      height: 17px;
      padding: 0 4px;
      border-radius: 999px;
      background: var(--dusty-rose);
      color: #fff;
      font-size: 10px;
      font-weight: 700;
      line-height: 17px;
      text-align: center;
      pointer-events: none;
    }

    /* ── Cart Drawer ───────────────────────────────────────────────────────── */
    .cart-drawer {
      position: fixed;
      inset: 0;
      z-index: 300;
      pointer-events: none;
    }
    .cart-drawer.open { pointer-events: all; }
    .cart-drawer-backdrop {
      position: absolute;
      inset: 0;
      background: rgba(0,0,0,0.45);
      opacity: 0;
      transition: opacity 0.25s;
    }
    .cart-drawer.open .cart-drawer-backdrop { opacity: 1; }
    .cart-panel {
      position: absolute;
      right: 0;
      top: 0;
      bottom: 0;
      width: 380px;
      max-width: 100vw;
      background: var(--warm-white);
      display: flex;
      flex-direction: column;
      transform: translateX(100%);
      transition: transform 0.3s ease;
      box-shadow: var(--shadow-lg);
    }
    .cart-drawer.open .cart-panel { transform: translateX(0); }

    .cart-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 20px 20px 16px;
      border-bottom: 1px solid var(--border);
      flex-shrink: 0;
    }
    .cart-heading {
      font-family: var(--font-serif);
      font-size: 20px;
      color: var(--charcoal);
    }
    .cart-close-btn {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      color: var(--mid-gray);
      transition: background var(--transition), color var(--transition);
    }
    .cart-close-btn:hover { background: var(--blush); color: var(--deep-rose); }

    /* Cart items list */
    .cart-items {
      flex: 1;
      overflow-y: auto;
      padding: 12px 20px;
    }
    .cart-empty {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 10px;
      height: 100%;
      color: var(--mid-gray);
      text-align: center;
    }
    .cart-empty svg { opacity: 0.35; }
    .cart-empty p { font-size: 14px; }

    .cart-item {
      display: grid;
      grid-template-columns: 68px 1fr auto;
      gap: 12px;
      align-items: center;
      padding: 12px 0;
      border-bottom: 1px solid var(--border);
    }
    .cart-item:last-child { border-bottom: none; }
    .cart-item-img {
      width: 68px;
      height: 68px;
      object-fit: cover;
      border-radius: var(--radius);
      background: var(--light-gray);
      flex-shrink: 0;
    }
    .cart-item-info { min-width: 0; }
    .cart-item-title {
      font-size: 13px;
      font-weight: 500;
      color: var(--charcoal);
      line-height: 1.35;
      margin-bottom: 4px;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
    .cart-item-price {
      font-size: 13px;
      font-weight: 700;
      color: var(--deep-rose);
      margin-bottom: 6px;
    }
    .qty-controls {
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .qty-btn {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      border: 1.5px solid var(--border);
      background: var(--warm-white);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 15px;
      line-height: 1;
      color: var(--charcoal);
      transition: border-color var(--transition), background var(--transition);
      flex-shrink: 0;
    }
    .qty-btn:hover { border-color: var(--rose); background: var(--blush); color: var(--deep-rose); }
    .qty-value {
      font-size: 13px;
      font-weight: 600;
      min-width: 18px;
      text-align: center;
    }
    .cart-item-remove {
      align-self: flex-start;
      padding: 4px;
      font-size: 14px;
      color: var(--mid-gray);
      transition: color var(--transition);
    }
    .cart-item-remove:hover { color: var(--deep-rose); }

    /* Cart footer */
    .cart-footer {
      padding: 16px 20px 20px;
      border-top: 1px solid var(--border);
      flex-shrink: 0;
      background: var(--warm-white);
    }
    .cart-subtotal {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 15px;
      margin-bottom: 14px;
    }
    .cart-subtotal-label { color: var(--mid-gray); }
    .cart-subtotal-amount { font-weight: 700; font-size: 18px; color: var(--charcoal); }
    .cart-checkout-btn {
      width: 100%;
      padding: 13px;
      background: var(--dusty-rose);
      color: #fff;
      border-radius: var(--radius);
      font-size: 15px;
      font-weight: 600;
      letter-spacing: 0.02em;
      transition: background var(--transition), transform var(--transition);
    }
    .cart-checkout-btn:hover { background: var(--deep-rose); transform: translateY(-1px); }
    .cart-checkout-btn:active { transform: none; }
    .cart-clear-btn {
      width: 100%;
      margin-top: 8px;
      padding: 8px;
      font-size: 13px;
      color: var(--mid-gray);
      border-radius: var(--radius);
      transition: background var(--transition), color var(--transition);
    }
    .cart-clear-btn:hover { background: var(--blush); color: var(--deep-rose); }

    /* ── Add to Cart button (modal) ────────────────────────────────────────── */
    .modal-add-to-cart-btn {
      width: 100%;
      padding: 13px;
      background: var(--dusty-rose);
      color: #fff;
      border-radius: var(--radius);
      font-size: 15px;
      font-weight: 600;
      margin-top: 20px;
      transition: background var(--transition), transform var(--transition);
      letter-spacing: 0.02em;
    }
    .modal-add-to-cart-btn:hover { background: var(--deep-rose); transform: translateY(-1px); }
    .modal-add-to-cart-btn:active { transform: none; }

    /* "Added!" flash state */
    .modal-add-to-cart-btn.added {
      background: var(--sage);
    }

    /* ── Footer ────────────────────────────────────────────────────────────── */
    footer {
      background: var(--charcoal);
      color: #c8b8b2;
      text-align: center;
      padding: 28px 24px;
      margin-top: 48px;
      font-size: 13px;
    }
    footer strong { color: #ecd8d2; }

    /* ── Responsive ────────────────────────────────────────────────────────── */
    @media (max-width: 900px) {
      .sidebar { display: none; }
      .page-wrapper { padding: 16px; }
      .modal { grid-template-columns: 1fr; }
      .modal-gallery { aspect-ratio: 4/3; }
      .modal-info { max-height: none; }
    }
    @media (max-width: 600px) {
      .header-inner { padding: 0 14px; gap: 12px; }
      .logo { font-size: 18px; }
      .sort-bar { display: none; }
      .product-grid { grid-template-columns: repeat(2, 1fr); gap: 12px; }
    }

    /* ── Mobile filter toggle ──────────────────────────────────────────────── */
    .mobile-filter-btn {
      display: none;
      align-items: center;
      gap: 6px;
      padding: 8px 14px;
      border: 1.5px solid var(--border);
      border-radius: 20px;
      font-size: 13px;
      color: var(--charcoal);
      background: var(--warm-white);
      margin-bottom: 14px;
    }
    @media (max-width: 900px) {
      .mobile-filter-btn { display: flex; }
    }

    /* Mobile sidebar drawer */
    .sidebar-drawer {
      display: none;
    }
    @media (max-width: 900px) {
      .sidebar-drawer {
        display: block;
        position: fixed;
        inset: 0;
        z-index: 150;
        pointer-events: none;
      }
      .sidebar-drawer.open { pointer-events: all; }
      .drawer-backdrop {
        position: absolute;
        inset: 0;
        background: rgba(0,0,0,0.4);
        opacity: 0;
        transition: opacity 0.25s;
      }
      .sidebar-drawer.open .drawer-backdrop { opacity: 1; }
      .drawer-panel {
        position: absolute;
        left: 0;
        top: 0;
        bottom: 0;
        width: 280px;
        background: var(--cream);
        padding: 24px 16px;
        overflow-y: auto;
        transform: translateX(-100%);
        transition: transform 0.28s ease;
      }
      .sidebar-drawer.open .drawer-panel { transform: translateX(0); }
      .drawer-close {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 20px;
        font-weight: 600;
        font-size: 16px;
      }
      .drawer-close button { font-size: 22px; color: var(--mid-gray); }
    }
  </style>
</head>
<body>

<div class="announcement">
  Handpicked stickers &amp; vinyl decals &mdash; ships from the US &nbsp;✦&nbsp; Made with care
</div>

<header class="site-header">
  <div class="header-inner">
    <div class="logo">Sticker<span>Co</span></div>

    <div class="search-bar">
      <input type="text" id="search-input" placeholder="Search stickers, tags..." autocomplete="off" />
      <span class="search-icon">
        <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
          <circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/>
        </svg>
      </span>
    </div>

    <div class="sort-bar">
      <label for="sort-select">Sort:</label>
      <select id="sort-select">
        <option value="default">Featured</option>
        <option value="price-asc">Lowest Price</option>
        <option value="price-desc">Highest Price</option>
      </select>
    </div>

    <button class="cart-btn" id="cart-btn" aria-label="Open cart">
      <svg width="22" height="22" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
        <path d="M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/>
        <line x1="3" y1="6" x2="21" y2="6"/>
        <path d="M16 10a4 4 0 0 1-8 0"/>
      </svg>
      <span class="cart-badge" id="cart-badge" style="display:none">0</span>
    </button>
  </div>
</header>

<!-- Hero Section -->
<section class="hero">
  <div class="hero-image">
    <img src="cover.png" alt="Featured sticker collection" />
  </div>
</section>

<!-- Cart Drawer -->
<div class="cart-drawer" id="cart-drawer" aria-label="Shopping cart" role="dialog">
  <div class="cart-drawer-backdrop" id="cart-drawer-backdrop"></div>
  <div class="cart-panel">
    <div class="cart-header">
      <h2 class="cart-heading">Your Cart</h2>
      <button class="cart-close-btn" id="cart-close-btn" aria-label="Close cart">&#x2715;</button>
    </div>
    <div class="cart-items" id="cart-items">
      <!-- rendered by JS -->
    </div>
    <div class="cart-footer" id="cart-footer">
      <!-- rendered by JS -->
    </div>
  </div>
</div>

<!-- Mobile filter drawer -->
<div class="sidebar-drawer" id="sidebar-drawer">
  <div class="drawer-backdrop" id="drawer-backdrop"></div>
  <div class="drawer-panel">
    <div class="drawer-close">
      <span>Filter by Tag</span>
      <button id="drawer-close-btn" aria-label="Close filters">&#x2715;</button>
    </div>
    <div id="drawer-tag-list" class="tag-list"></div>
  </div>
</div>

<div class="page-wrapper">
  <!-- Desktop Sidebar -->
  <aside class="sidebar">
    <div class="sidebar-section">
      <div class="sidebar-title">Filter by Tag</div>
      <div id="sidebar-tag-list" class="tag-list"></div>
      <button class="clear-btn" id="clear-filter-btn" style="display:none">Clear filter</button>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="main-area">
    <button class="mobile-filter-btn" id="mobile-filter-btn">
      <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
        <line x1="4" y1="6" x2="20" y2="6"/><line x1="8" y1="12" x2="16" y2="12"/><line x1="10" y1="18" x2="14" y2="18"/>
      </svg>
      Filter &amp; Sort
    </button>

    <div class="results-bar">
      <div class="results-count" id="results-count">Loading products...</div>
      <div id="active-filter-display"></div>
    </div>

    <div class="product-grid" id="product-grid">
      <!-- Skeleton loaders -->
      ${Array(12).fill(0).map(() => `
      <div class="skeleton-card">
        <div class="skeleton-img"></div>
        <div class="skeleton-body">
          <div class="skeleton-line"></div>
          <div class="skeleton-line short"></div>
        </div>
      </div>`).join('')}
    </div>

    <div class="pagination" id="pagination"></div>
  </main>
</div>

<!-- Product Modal -->
<div class="modal-backdrop" id="modal-backdrop" role="dialog" aria-modal="true" aria-label="Product details">
  <div class="modal" id="modal">
    <button class="modal-close" id="modal-close" aria-label="Close">&#x2715;</button>

    <!-- Gallery -->
    <div class="modal-gallery" id="modal-gallery">
      <img class="gallery-main" id="gallery-main-img" src="" alt="" />
      <button class="gallery-nav prev" id="gallery-prev" aria-label="Previous image">&#8249;</button>
      <button class="gallery-nav next" id="gallery-next" aria-label="Next image">&#8250;</button>
      <div class="gallery-thumbs" id="gallery-thumbs"></div>
    </div>

    <!-- Info -->
    <div class="modal-info" id="modal-info">
      <h2 class="modal-title" id="modal-title"></h2>
      <div class="modal-price" id="modal-price"></div>
      <div class="modal-tags" id="modal-tags"></div>
      <button class="modal-add-to-cart-btn" id="modal-add-to-cart-btn">Add to Cart</button>
      <hr class="modal-divider" style="margin-top:20px;" />
      <div class="modal-desc-label">Description</div>
      <div class="modal-desc" id="modal-desc"></div>
    </div>
  </div>
</div>

<footer>
  <strong>StickerCo</strong> &mdash; Independent sticker shop &nbsp;&bull;&nbsp; All products handpicked with love
</footer>

<script>
// ── State ─────────────────────────────────────────────────────────────────────
// cart items: [{ id, title, price, currency, image, quantity }]
function loadCartFromStorage() {
  try { return JSON.parse(localStorage.getItem('stickerco_cart') || '[]'); }
  catch { return []; }
}

const state = {
  search: '',
  tag: '',
  sort: 'default',
  page: 1,
  limit: 24,
  total: 0,
  products: [],
  allTags: [],
  loading: false,
  modal: null,
  galleryIndex: 0,
  cart: loadCartFromStorage(),
  cartOpen: false,
};

// ── Cart Logic ────────────────────────────────────────────────────────────────
function saveCart() {
  localStorage.setItem('stickerco_cart', JSON.stringify(state.cart));
}

function cartItemCount() {
  return state.cart.reduce((sum, item) => sum + item.quantity, 0);
}

function cartSubtotal() {
  return state.cart.reduce((sum, item) => sum + item.price * item.quantity, 0);
}

function addToCart(product, triggerBtn) {
  const existing = state.cart.find(i => i.id === product.id);
  if (existing) {
    existing.quantity++;
  } else {
    state.cart.push({
      id:       product.id,
      title:    product.title,
      price:    product.price,
      currency: product.currency,
      image:    product.images[0] || '',
      quantity: 1,
    });
  }
  saveCart();
  updateCartBadge();
  renderCartDrawer();

  // Brief "Added!" flash on the button
  if (triggerBtn) {
    triggerBtn.textContent = 'Added!';
    triggerBtn.classList.add('added');
    setTimeout(() => {
      triggerBtn.textContent = 'Add to Cart';
      triggerBtn.classList.remove('added');
    }, 1200);
  }
}

function removeFromCart(id) {
  state.cart = state.cart.filter(i => i.id !== id);
  saveCart();
  updateCartBadge();
  renderCartDrawer();
}

function setCartQty(id, qty) {
  if (qty < 1) { removeFromCart(id); return; }
  const item = state.cart.find(i => i.id === id);
  if (item) item.quantity = qty;
  saveCart();
  updateCartBadge();
  renderCartDrawer();
}

function clearCart() {
  state.cart = [];
  saveCart();
  updateCartBadge();
  renderCartDrawer();
}

function updateCartBadge() {
  const badge = document.getElementById('cart-badge');
  const count = cartItemCount();
  if (count > 0) {
    badge.textContent = count > 99 ? '99+' : count;
    badge.style.display = 'block';
  } else {
    badge.style.display = 'none';
  }
}

function openCartDrawer() {
  state.cartOpen = true;
  document.getElementById('cart-drawer').classList.add('open');
  document.body.style.overflow = 'hidden';
}

function closeCartDrawer() {
  state.cartOpen = false;
  document.getElementById('cart-drawer').classList.remove('open');
  document.body.style.overflow = '';
}

function renderCartDrawer() {
  const itemsEl  = document.getElementById('cart-items');
  const footerEl = document.getElementById('cart-footer');

  if (state.cart.length === 0) {
    itemsEl.innerHTML = `
      <div class="cart-empty">
        <svg width="56" height="56" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
          <path d="M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/>
          <line x1="3" y1="6" x2="21" y2="6"/>
          <path d="M16 10a4 4 0 0 1-8 0"/>
        </svg>
        <p>Your cart is empty.<br>Start adding some stickers!</p>
      </div>`;
    footerEl.innerHTML = '';
    return;
  }

  itemsEl.innerHTML = state.cart.map(item => `
    <div class="cart-item" data-cart-item-id="${item.id}">
      <img class="cart-item-img" src="${escHtml(item.image)}" alt="${escHtml(item.title)}" loading="lazy" />
      <div class="cart-item-info">
        <div class="cart-item-title">${escHtml(item.title)}</div>
        <div class="cart-item-price">${formatPrice(item.price, item.currency)}</div>
        <div class="qty-controls">
          <button class="qty-btn qty-dec" data-id="${item.id}" aria-label="Decrease quantity">&#8722;</button>
          <span class="qty-value">${item.quantity}</span>
          <button class="qty-btn qty-inc" data-id="${item.id}" aria-label="Increase quantity">&#43;</button>
        </div>
      </div>
      <button class="cart-item-remove" data-id="${item.id}" aria-label="Remove item">&#x2715;</button>
    </div>
  `).join('');

  const subtotal = cartSubtotal();
  const currency = state.cart[0].currency;
  footerEl.innerHTML = `
    <div class="cart-subtotal">
      <span class="cart-subtotal-label">Subtotal (${cartItemCount()} item${cartItemCount() !== 1 ? 's' : ''})</span>
      <span class="cart-subtotal-amount">${formatPrice(subtotal, currency)}</span>
    </div>
    <button class="cart-checkout-btn" id="cart-checkout-btn">Proceed to Checkout</button>
    <button class="cart-clear-btn" id="cart-clear-btn">Clear cart</button>
  `;

  // Wire up qty + remove buttons
  itemsEl.querySelectorAll('.qty-dec').forEach(btn => {
    btn.onclick = () => setCartQty(parseInt(btn.dataset.id, 10), state.cart.find(i => i.id === parseInt(btn.dataset.id, 10))?.quantity - 1);
  });
  itemsEl.querySelectorAll('.qty-inc').forEach(btn => {
    btn.onclick = () => setCartQty(parseInt(btn.dataset.id, 10), state.cart.find(i => i.id === parseInt(btn.dataset.id, 10))?.quantity + 1);
  });
  itemsEl.querySelectorAll('.cart-item-remove').forEach(btn => {
    btn.onclick = () => removeFromCart(parseInt(btn.dataset.id, 10));
  });

  document.getElementById('cart-clear-btn').onclick = clearCart;
  // Checkout button: placeholder — Stripe integration will go here
  document.getElementById('cart-checkout-btn').onclick = () => {
    alert('Checkout coming soon!');
  };
}

// ── DOM refs ──────────────────────────────────────────────────────────────────
const grid         = document.getElementById('product-grid');
const pagination   = document.getElementById('pagination');
const resultsCount = document.getElementById('results-count');
const searchInput  = document.getElementById('search-input');
const sortSelect   = document.getElementById('sort-select');
const sidebarTags  = document.getElementById('sidebar-tag-list');
const drawerTags   = document.getElementById('drawer-tag-list');
const clearBtn     = document.getElementById('clear-filter-btn');
const activeFilter = document.getElementById('active-filter-display');
const modalBg      = document.getElementById('modal-backdrop');
const modalClose   = document.getElementById('modal-close');
const galleryMain  = document.getElementById('gallery-main-img');
const galleryThumbs= document.getElementById('gallery-thumbs');
const galleryPrev  = document.getElementById('gallery-prev');
const galleryNext  = document.getElementById('gallery-next');
const modalTitle   = document.getElementById('modal-title');
const modalPrice   = document.getElementById('modal-price');
const modalTags    = document.getElementById('modal-tags');
const modalDesc    = document.getElementById('modal-desc');
const drawer       = document.getElementById('sidebar-drawer');
const drawerBackdrop = document.getElementById('drawer-backdrop');
const mobileFilterBtn = document.getElementById('mobile-filter-btn');
const drawerCloseBtn  = document.getElementById('drawer-close-btn');

// ── API ───────────────────────────────────────────────────────────────────────
async function fetchProducts() {
  state.loading = true;
  const params = new URLSearchParams({
    page: state.page,
    limit: state.limit,
    sort: state.sort,
  });
  if (state.search) params.set('search', state.search);
  if (state.tag)    params.set('tag', state.tag);

  const res  = await fetch('/api/products?' + params);
  const data = await res.json();
  state.products = data.items;
  state.total    = data.total;
  state.loading  = false;
  render();
}

async function fetchTags() {
  const res  = await fetch('/api/tags');
  state.allTags = await res.json();
  renderTags();
}

// ── Render helpers ─────────────────────────────────────────────────────────────
function formatPrice(price, currency) {
  return new Intl.NumberFormat('en-US', {
    style: 'currency',
    currency: currency || 'USD',
    minimumFractionDigits: 2,
  }).format(price);
}

function cardHTML(p) {
  const hasHover = p.images.length > 1;
  const dots = p.images.slice(0, 5).map((_, i) =>
    `<div class="img-dot ${i === 0 ? 'active' : ''}"></div>`
  ).join('');

  return `
    <div class="product-card" data-id="${p.id}">
      <div class="card-img-wrap">
        <img class="img-primary" src="${p.images[0]}" alt="${escHtml(p.title)}" loading="lazy" />
        ${hasHover ? `<img class="img-hover" src="${p.images[1]}" alt="" loading="lazy" />` : ''}
        ${p.images.length > 1 ? `<div class="img-dots">${dots}</div>` : ''}
      </div>
      <div class="card-body">
        <div class="card-title">${escHtml(p.title)}</div>
        <div class="card-price">${formatPrice(p.price, p.currency)}</div>
      </div>
    </div>`;
}

function render() {
  // Results count
  const from = state.total === 0 ? 0 : (state.page - 1) * state.limit + 1;
  const to   = Math.min(state.page * state.limit, state.total);
  resultsCount.textContent = state.total === 0
    ? 'No products found'
    : `Showing ${from}–${to} of ${state.total} products`;

  // Active filter pill
  if (state.tag) {
    activeFilter.innerHTML = `
      <span class="active-filter-tag">
        ${escHtml(state.tag)}
        <button aria-label="Remove filter" id="remove-tag-btn">&#x2715;</button>
      </span>`;
    document.getElementById('remove-tag-btn').onclick = () => setTag('');
    clearBtn.style.display = 'block';
  } else {
    activeFilter.innerHTML = '';
    clearBtn.style.display = 'none';
  }

  // Grid
  if (state.products.length === 0) {
    grid.innerHTML = `
      <div class="empty-state">
        <h3>No stickers found</h3>
        <p>Try a different search term or remove filters.</p>
      </div>`;
  } else {
    grid.innerHTML = state.products.map(cardHTML).join('');
  }

  // Event delegation for cards
  grid.querySelectorAll('.product-card').forEach(card => {
    card.addEventListener('click', () => openModal(parseInt(card.dataset.id, 10)));
  });

  renderPagination();
  renderTags(); // update active states
}

function renderTags() {
  const makeTagHTML = (t, container) => {
    const btn = document.createElement('button');
    btn.className = 'tag-btn' + (state.tag === t.tag ? ' active' : '');
    btn.innerHTML = `${escHtml(t.tag)}<span class="tag-count">${t.count}</span>`;
    btn.onclick = () => setTag(state.tag === t.tag ? '' : t.tag);
    return btn;
  };

  [sidebarTags, drawerTags].forEach(container => {
    container.innerHTML = '';
    state.allTags.forEach(t => container.appendChild(makeTagHTML(t, container)));
  });
}

function renderPagination() {
  const totalPages = Math.ceil(state.total / state.limit);
  if (totalPages <= 1) { pagination.innerHTML = ''; return; }

  let html = `<button class="page-btn" id="pg-prev" ${state.page === 1 ? 'disabled' : ''}>&#8249;</button>`;

  const range = pageRange(state.page, totalPages);
  range.forEach(p => {
    if (p === '…') {
      html += `<span style="padding: 0 4px; color: var(--mid-gray)">…</span>`;
    } else {
      html += `<button class="page-btn ${p === state.page ? 'active' : ''}" data-page="${p}">${p}</button>`;
    }
  });

  html += `<button class="page-btn" id="pg-next" ${state.page === totalPages ? 'disabled' : ''}>&#8250;</button>`;
  pagination.innerHTML = html;

  document.getElementById('pg-prev').onclick = () => goPage(state.page - 1);
  document.getElementById('pg-next').onclick = () => goPage(state.page + 1);
  pagination.querySelectorAll('[data-page]').forEach(btn => {
    btn.onclick = () => goPage(parseInt(btn.dataset.page, 10));
  });
}

function pageRange(current, total) {
  const delta = 2;
  const range = [];
  const result = [];
  let last;
  for (let i = 1; i <= total; i++) {
    if (i === 1 || i === total || (i >= current - delta && i <= current + delta)) range.push(i);
  }
  range.forEach(i => {
    if (last && i - last > 1) result.push('…');
    result.push(i);
    last = i;
  });
  return result;
}

// ── State mutations ───────────────────────────────────────────────────────────
function setTag(tag) {
  state.tag = tag;
  state.page = 1;
  closeDrawer();
  fetchProducts();
}

function goPage(p) {
  state.page = p;
  window.scrollTo({ top: 0, behavior: 'smooth' });
  fetchProducts();
}

// ── Search debounce ───────────────────────────────────────────────────────────
let searchTimer;
searchInput.addEventListener('input', () => {
  clearTimeout(searchTimer);
  searchTimer = setTimeout(() => {
    state.search = searchInput.value.trim();
    state.page = 1;
    fetchProducts();
  }, 320);
});

sortSelect.addEventListener('change', () => {
  state.sort = sortSelect.value;
  state.page = 1;
  fetchProducts();
});

clearBtn.addEventListener('click', () => setTag(''));

// ── Modal ─────────────────────────────────────────────────────────────────────
async function openModal(id) {
  const res = await fetch('/api/product/' + id);
  const p   = await res.json();
  state.modal = p;
  state.galleryIndex = 0;

  modalTitle.textContent = p.title;
  modalPrice.textContent = formatPrice(p.price, p.currency);
  modalDesc.textContent  = p.description || 'No description available.';

  // Tags
  modalTags.innerHTML = p.tags.map(t =>
    `<span class="modal-tag-chip" data-tag="${escHtml(t)}">${escHtml(t)}</span>`
  ).join('');
  modalTags.querySelectorAll('.modal-tag-chip').forEach(chip => {
    chip.onclick = () => { closeModal(); setTag(chip.dataset.tag); };
  });

  // Modal Add to Cart
  const modalAtcBtn = document.getElementById('modal-add-to-cart-btn');
  modalAtcBtn.onclick = () => addToCart(p, modalAtcBtn);

  renderGallery();
  modalBg.classList.add('open');
  document.body.style.overflow = 'hidden';
}

function renderGallery() {
  const p = state.modal;
  const imgs = p.images;
  const idx = state.galleryIndex;

  galleryMain.src = imgs[idx];
  galleryMain.alt = p.title;

  galleryPrev.disabled = idx === 0;
  galleryNext.disabled = idx === imgs.length - 1;

  // Thumbnails (show up to 6)
  galleryThumbs.style.display = imgs.length > 1 ? 'flex' : 'none';
  galleryThumbs.innerHTML = imgs.slice(0, 6).map((src, i) =>
    `<button class="thumb-btn ${i === idx ? 'active' : ''}" data-idx="${i}">
       <img src="${src}" alt="Image ${i+1}" loading="lazy" />
     </button>`
  ).join('');
  galleryThumbs.querySelectorAll('.thumb-btn').forEach(btn => {
    btn.onclick = () => { state.galleryIndex = parseInt(btn.dataset.idx, 10); renderGallery(); };
  });
}

galleryPrev.onclick = () => { state.galleryIndex--; renderGallery(); };
galleryNext.onclick = () => { state.galleryIndex++; renderGallery(); };

function closeModal() {
  modalBg.classList.remove('open');
  document.body.style.overflow = '';
  state.modal = null;
}

modalClose.onclick = closeModal;
modalBg.addEventListener('click', e => { if (e.target === modalBg) closeModal(); });
document.addEventListener('keydown', e => { if (e.key === 'Escape') closeModal(); });

// ── Cart drawer events ────────────────────────────────────────────────────────
document.getElementById('cart-btn').onclick           = openCartDrawer;
document.getElementById('cart-close-btn').onclick     = closeCartDrawer;
document.getElementById('cart-drawer-backdrop').onclick = closeCartDrawer;

// ── Mobile drawer ─────────────────────────────────────────────────────────────
mobileFilterBtn.onclick  = () => drawer.classList.add('open');
drawerBackdrop.onclick   = closeDrawer;
drawerCloseBtn.onclick   = closeDrawer;
function closeDrawer() { drawer.classList.remove('open'); }

// ── Utilities ─────────────────────────────────────────────────────────────────
function escHtml(str) {
  return String(str)
    .replace(/&/g, '&amp;')
    .replace(/</g, '&lt;')
    .replace(/>/g, '&gt;')
    .replace(/"/g, '&quot;');
}

// ── Init ──────────────────────────────────────────────────────────────────────
updateCartBadge();   // restore badge count from localStorage on first load
Promise.all([fetchTags(), fetchProducts()]);
</script>

</body>
</html>
